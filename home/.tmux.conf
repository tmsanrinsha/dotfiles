# åŸºæœ¬è¨­å®š {{{1
# ============================================================================
## ä»¥ä¸‹ã®ã‚ˆã†ã«çœç•¥ã§ãã‚‹
# set-option => set
# set-window-option => setw

## Prefixã‚­ãƒ¼ã®å¤‰æ›´
# æ—¢å®šã®Prefixã‚­ãƒ¼(Ctrl+b)ã®å‰²ã‚Šå½“ã¦ã‚’è§£é™¤
unbind-key C-b
# Ctrl+qã‚’Prefixã‚­ãƒ¼ã«ã™ã‚‹
set-option -g prefix C-q
# Ctrl+q, qã§Ctrl+qã‚’é€ã‚‹
bind-key q send-prefix

# 256è‰²
# tmuxèµ·å‹•æ™‚ã«$TERMã«256è‰²ã«å¯¾å¿œã—ãŸç«¯æœ«(xterm-256colorãªã©)ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã¨
# 256è‰²ãŒä½¿ãˆã‚‹ãŒã€ãã†ã§ãªã„å ´åˆã¯tmux -2ã¨æ‰“ã£ã¦èµ·å‹•ã™ã‚‹ã¨ã€256è‰²ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
# èµ·å‹•å¾Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯$TERMã¯screenã«ãªã‚‹ã€‚
# emacsãªã©ã§256è‰²ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã«ã¯screen-256colorã®ã™ã‚‹
set-option -g default-terminal "screen-256color"
# xterm*ã«è¨­å®šã™ã‚‹ã¨vimã®èƒŒæ™¯è‰²ãŒãŠã‹ã—ããªã‚‹ã®ã§ xterm-256colorã«ã¯è¨­å®šã—ãªã„

# è¨­å®šãƒªãƒ­ãƒ¼ãƒ‰
bind r source-file ~/.tmux.conf \; display-message "tmux RELOADED!!"

# screen ã§è¨€ã†ã¨ã“ã‚ã® scrollback
set-option -g history-limit 50000
set-option -g buffer-limit 20

# ç«¯æœ«ã®ã‚¿ã‚¤ãƒˆãƒ«ã€åŠ¹ã„ã¦ãªã„ï¼Ÿ
set-option -g set-titles on
set-option -g set-titles-string "tmux.#I.#W"

set-option -g visual-activity on
set-window-option -g monitor-activity on
#set-option -g visual-silence on
#set-window-option -g monitor-silence 1
#ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºæ™‚é–“
set-option -g display-time 1000

# Escã‚’æ‰“ã£ãŸã‚ã¨ã®å¾…ã¡æ™‚é–“
set-option -g escape-time 10

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç­‰ã®ç•ªå·åŸºæº–å€¤
set-option -g base-index 1
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜æ™‚ã«ç•ªå·ã‚’æŒ¯ã‚Šç›´ã™
set-option -g renumber-windows on

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦åãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹
set-window-option -g automatic-rename off
# ã“ã®è¨­å®šã§ã†ã¾ãã„ã‹ãªã„ã¨ãã¯
# .zshrcã«ä»¥ä¸‹ã®è¨­å®šã‚’ã™ã‚‹
# DISABLE_AUTO_TITLE=true
# å‚ç…§:http://qiita.com/items/c166700393481cb15e0c

# style {{{1
# ============================================================================
# Solarized 256 {{{2
# ----------------------------------------------------------------------------
# default statusbar colors
# set-option -g status-fg colour136 #yellow
set-option -g status-fg white
set-option -g status-bg colour235 #base02
set-option -g status-attr default
# default window title colors
set-window-option -g window-status-fg colour244 #base0
set-window-option -g window-status-bg default
#set-window-option -g window-status-attr dim
# active window title colors
set-window-option -g window-status-current-fg white
# set-window-option -g window-status-current-fg colour166 #orange
# set-window-option -g window-status-current-bg colour202 #colour27 #blue
set-window-option -g window-status-current-bg colour27 #blue
# set-window-option -g window-status-current-bg default
#set-window-option -g window-status-current-attr bright
# pane border
set-option -g pane-border-fg colour244 #base0
set-option -g pane-active-border-fg colour37 #cyan
# message text
set-option -g message-fg yellow
set-option -g message-bg colour235 #base02
# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange
# clock
set-window-option -g clock-mode-colour colour64 #green

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã‚«ã‚¹ã‚¿ãƒ é–¢é€£
# set-option -g status-fg white
# set-option -g status-attr dim

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã‚«ã‚¹ã‚¿ãƒ é–¢é€£
# set-option -g status-fg white
# set-option -g status-attr dim

# Ingress {{{2
# ----------------------------------------------------------------------------
# # default statusbar colors
# set-option -g status-fg colour87
# set-option -g status-bg colour235
# set-option -g status-attr default
#
# # default window title colors
# set-window-option -g window-status-fg colour30
# set-window-option -g window-status-bg default
#
# # active window title colors
# set-window-option -g window-status-current-fg colour87
# set-window-option -g window-status-current-bg colour24
# set-window-option -g window-status-current-attr bold
#
# # pane border
# set-option -g pane-border-fg colour244
# set-option -g pane-active-border-fg colour87
#
# # message text
# set-option -g message-fg colour87
# set-option -g message-bg colour235
#
# # copy mode
# set-window-option -g mode-fg colour87
# set-window-option -g mode-bg colour24
# set-window-option -g mode-attr bold
#
# # pane number display
# set-option -g display-panes-active-colour colour87
# set-option -g display-panes-colour colour30
#
# # clock
# set-window-option -g clock-mode-colour colour87

# status {{{1
# ============================================================================
# å·¦éƒ¨:whoami@hostname
# set-option -g status-left '#50[fg=green,bold][#20(whoami)@#H]#[default]'
set-option -g status-left '#{?pane_synchronized,#[bg=red],}#{?client_prefix,#[bg=cyan],}[#S]'
# å³éƒ¨:[2011/03/06(Sun)20:21]
#set-option -g status-right '#[fg=white,bold][%Y/%m/%d(%a)%H:%M]#[default]'
set-option -g status-right '[%Y/%m/%d(%a)%H:%M]'
# set-option -g status-right-bg black #colour235

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³æ›´æ–°é–“éš”(ç§’)
# set-option -g status-interval 5
# set-option -g status-left-length 100
# set-option -g status-right-length 50

# set-option -g message-attr bold
# set-option -g message-fg white
# set-option -g message-bg red

# set-window-option -g mode-bg white
# set-window-option -g mode-fg black

# session {{{1
# ==============================================================================
bind C command-prompt "new-session -s '%%'"
bind Space choose-session
bind Q switch-client -l # last-sessionã«ç§»å‹•
bind a attach-session -d # è‡ªåˆ†ä»¥å¤–ã‚’ãƒ‡ã‚¿ãƒƒãƒã•ã›ã‚‹

# window {{{1
# ============================================================================
# æ–°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½œæˆ
bind c new-window
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦çµ‚äº†
bind K confirm-before -p "kill-window #I? (y/n)" kill-window
# ç›´å‰ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
bind C-q last-window
# æ¬¡ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
bind C-n next-window
# å‰ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
bind C-p previous-window
# windowã‚’pecoã§é¸æŠã™ã‚‹
bind w split-window -c '#{pane_current_path}' "tmux list-windows -F '#{window_index}: #{window_name}#{window_flags} (#{window_panes} panes) #{pane_current_path} #{?window_active, (active),}' | peco | cut -d':' -f 1 | xargs tmux select-window -t"

# sshå…ˆã§windowåˆ†å‰²ãƒ»ç”Ÿæˆã—ã¦sshå…ˆã«æ¥ç¶šã™ã‚‹ {{{2
# ----------------------------------------------------------------------------
bind C-s run-shell "tmux split-window -v \"eval $(ps -t #{pane_tty} | awk '/[s]sh/ {print $4,$5}'); exec $SHELL\""
bind C-v run-shell "tmux split-window -h \"eval $(ps -t #{pane_tty} | awk '/[s]sh/ {print $4,$5}'); exec $SHELL\""
bind C-c run-shell "tmux neww            \"eval $(ps -t #{pane_tty} | awk '/[s]sh/ {print $4,$5}'); exec $SHELL\""

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ç§»å‹•
# ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’editorã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ç§»å‹•
#  prefix . editor
# processesã®1ã‚’editorã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ç§»å‹•ã™ã‚‹
#  move-window -s processes:1 -t editor

# pain {{{1
# ============================================================================
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ç¸¦åˆ†å‰²
bind s split-window -v
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®æ¨ªåˆ†å‰²
bind v split-window -h

# ãƒšã‚¤ãƒ³é–“ã®ç§»å‹•
bind k   select-pane -U
bind C-k select-pane -U
bind j   select-pane -D
bind C-j select-pane -D
bind h   select-pane -L
bind C-h select-pane -L
bind l   select-pane -R
bind C-l select-pane -R

# ãƒšã‚¤ãƒ³ã®ç§»å‹•
# last-windowã®last-paneã¨ç¾åœ¨ã®paneã®äº¤æ›
bind ^ swap-pane -s :!
# join-pane
# http://d.hatena.ne.jp/kozo2/20111202/1322827858
# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒšã‚¤ãƒ³ã‚’å‰å›ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ç§»å‹•ã™ã‚‹
bind > join-pane -t:!
# å‰å›ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒšã‚¤ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å¼•ã£å¼µã£ã¦ãã‚‹
bind < join-pane -s:!

# http://d.hatena.ne.jp/kozo2/?of=-17
#bind-key C-n swap-window -t:+ \; swap-pane -s:-
#bind-key C-p swap-window -t:- \; swap-pane -s:+

# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒšã‚¤ãƒ³ã‚’æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ†å‰²ã™ã‚‹
bind b break-pane

# ãƒšã‚¤ãƒ³ãƒªã‚µã‚¤ã‚º
bind -r Left  resize-pane -L 5
bind -r Right resize-pane -R 5
bind -r Down  resize-pane -D 5
bind -r Up    resize-pane -U 5
bind -r M-h   resize-pane -L 40
bind -r M-l   resize-pane -R 40
bind -r M-j   resize-pane -D 10
bind -r M-k   resize-pane -U 10

# ãƒšã‚¤ãƒ³ç•ªå·è¡¨ç¤º
bind L display-panes

# ãƒšã‚¤ãƒ³ã®åŒæœŸã®ãƒˆã‚°ãƒ«
bind-key S set-window-option synchronize-panes
#}}}
# copy mode {{{
# ==============================================================================
# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰çªå…¥
bind [ copy-mode
# ãƒšãƒ¼ã‚¹ãƒˆ
#bind p paste-buffer

# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ã®ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã‚’ vi é¢¨ã«ã™ã‚‹
# :list-keys -t vi-copy. ã§ç¢ºèªå¯èƒ½
set-window-option -g mode-key vi
bind -t vi-copy v begin-selection
bind -t vi-copy C-v rectangle-toggle
# ã§ããªã„
# bind -t vi-copy C-v rectangle-toggle \; send-keys v
bind -t vi-copy y copy-selection

bind -t vi-copy @ search-again
bind -t vi-copy ` search-reverse
# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®2ã¤ä¸Šã®å‡ºåŠ›çµæœã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãƒšãƒ¼ã‚¹ãƒˆ
# Eã§ã¯ãªã$ã‚’ä½¿ã„ãŸã„ãŒã†ã¾ãã„ã‹ãªã„
bind * copy-mode \; send-keys kk 0 Space E C-m \; paste \;

# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ã‚³ãƒ”ãƒ¼ã—ãŸå¾Œã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ä¿å­˜ã•ã‚Œãªã„ã¨ã
# http://doda.b.sourceforge.jp/2011/12/15/tmux-set-clipboard/
set-option -ag terminal-overrides ",*:Ms=\\E]52;%p1%s;%p2%s\\7"
#}}}
# command prompt {{{
# =============================================================================
set-window-option -g status-keys emacs
# }}}
# mouse {{{1
# ==============================================================================
if-shell "[[ $(echo \"$(tmux -V | cut -d' ' -f2) < 2.1\" | bc) == 1 ]]" "\
    set-option -g mode-mouse on;\
    set-option -g mouse-select-pane on;\
    set-option -g mouse-select-window on;\
    set-option -g mouse-resize-pane on;\
"
# set-option -g mode-mouse on          ãƒã‚¦ã‚¹ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰
# set-option -g mouse-select-pane on   ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯ã§ãƒšã‚¤ãƒ³é¸æŠ
# set-option -g mouse-select-window on ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯ã§windowé¸æŠ
# set-option -g mouse-resize-pane on   ãƒã‚¦ã‚¹ã§ãƒšã‚¤ãƒ³ã®å¤§ãã•ã®å¤‰æ›´

if-shell "[[ $(echo \"$(tmux -V | cut -d' ' -f2) >= 2.1\" | bc) == 1 ]]" "set -g mouse on"

# ç‰¹æ®Šãªã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã®è¨­å®š {{{1
# ============================================================================
set-window-option -g xterm-keys on # to make ctrl-arrow, etc. work
# http://sanrinsha.lolipop.jp/blog/2012/07/%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%81%A7ctrltab%E3%81%A8%E3%81%8B%E3%82%92%E4%BD%BF%E3%81%86.html
# Ctrl+Tab, Shift+Ctrl+Tabã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ‡ã‚Šæ›¿ãˆ
# Ctrl+æ•°å€¤ã§ãã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç•ªå·ã«åˆ‡ã‚Šæ›¿ãˆ
set-option -ag terminal-overrides ",*:kf13=[27;5;9~:kf14=[27;6;9~:kf15=[27;5;49~:kf16=[27;5;50~:kf17=[27;5;51~:kf18=[27;5;52~:kf19=[27;5;53~:kf20=[27;5;54~"
# prefix :server-infoã§ç¢ºèª

# bind -n S-F1 next
# bind -n S-F2 prev
# bind -n S-F3 select-window -t 1
# bind -n S-F4 select-window -t 2
# bind -n S-F5 select-window -t 3
# bind -n S-F6 select-window -t 4
# bind -n S-F7 select-window -t 5

# plugin {{{1
# ============================================================================
# tmux plugin manager
set -g @plugin 'tmux-plugins/tpm'

# ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã®ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®é–‹å§‹ã¨çµ‚äº†ã‚’tmux 2.1ã‚ˆã‚Šå‰ã®æŒ™å‹•ã«ã™ã‚‹
set -g @plugin 'nhdaly/tmux-scroll-copy-mode'

# copy modeã§æ­£è¦è¡¨ç¾ã§æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹
# ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹
# ã‚ã‚‰ã‹ã˜ã‚è¨­å®šã•ã‚ŒãŸä¾¿åˆ©ãªæ­£è¦è¡¨ç¾ãŒä½¿ãˆã‚‹
set -g @plugin 'tmux-plugins/tmux-copycat'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# tmuxinator
# If you use a base-index other than the default, please be sure to also set the pane-base-index
set-window-option -g pane-base-index 1

# vim: filetype=tmux commentstring=#%s
